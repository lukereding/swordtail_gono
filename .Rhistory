geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text(data = df, aes(x = long, y = lat, label = lab), vjust = 0, nudge_y = 0.5) +
# geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text_repel(data = low, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(0.1, 0.2),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# geom_text_repel(data = high, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(-0.3, -0.1),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# scale_color_powder(name = "potential for sexual conflict", guide = F) +
labs(x = "longitude", y = "latitude") +
coord_map())
ggsave("~/Desktop/figures_for_molly/map_short.pdf", height = 5, width = 7)
df <- tibble::frame_data(~long, ~lat, ~country, ~location, ~lab, ~type, ~site,
-97, 25.9, "US", "Brownsville TX", "Poecilia latipinna", "low", 1,
-97, 25.9,"US", "Brownsville TX", "Gambusia affinis", "high",1,
-98.5, 20.8, "Mexico", "Calnali HGO", "Xiphophorus malinche", "low",2,
-98.5, 20.8, "Mexico","Calnali HGO","Pseudoxiphophorus jonesii", "high",2,
-100.9, 22.1, "Mexico", "Nac. Rio Choy SLP", "Gambusia vitatta", "high",3,
-100.9, 22.1, "Mexico","Nac. Rio Choy SLP","Xiphophorus nigrensis", "low",3,
-102.525, 25.82, "Mexico", "4 Ciénegas COAH", "Xiphophorus gordoni", "low", 4,
-102.525, 25.82, "Mexico","4 Ciénegas COAH","Gambusia marshi", "high",4,
-98.78, 22, "Mexico", "Media luna SLP", "Poecilia latipunctata", "low",5,
-98.78, 22, "Mexico","Media luna SLP","Gambusia atrora" , "high",5,
-98.339, 21.01, "Mexico", "Atlapexco HGO", "Xiphophorus birchmanni", "low",6,
-98.339, 21.01, "Mexico", "Atlapexco HGO","Gambusia vitatta", "high",6,
-98.285, 20.834, "Mexico", "Xochiatipan HGO", "Xiphophorus variatus", "low",7,
-98.285, 20.834, "Mexico","Xochiatipan HGO","Gambusia regani", "high",7,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Poecilia velifera", "low",8,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Gambusia yucateca", "high",8,
-91.969, 17.487, "Mexico", "Palenque Chiapas", "Priapella compressa", "low", 9,
-91.969, 17.487, "Mexico","Palenque Chiapas","Phallichthys hubbsi", "high", 9,
-96.324, 19.32, "Mexico", "R. La Antigua VER", "Xiphophorus hellerii", "low", 10,
-96.324, 19.32, "Mexico","R. La Antigua VER", "Heterandria bimaculata", "high", 10,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Xiphophorus maculatus", "low", 11,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Heterophallus milleri", "high", 11,
-94.412, 18.147, "Mexico", "R. Coatzacoalcos VER", "Priapella intermedia", "low", 12,
-94.412, 18.147, "Mexico","R. Coatzacoalcos VER","Heterophallus rachovii", "high", 12,
-77.9956, 8.256, "Panama","Darien","Poecilia caucana", "low", 13,
-77.9956, 8.256, "Panama","Darien","Priapichthys darienensis", "high", 13,
-79.701, 9.1156, "Panama", "Gamboa", "Poecilia sphenops", "low", 14,
-79.701, 9.1156, "Panama","Gamboa","Neoheterandria tridentiger", "high", 14,
-84.209, 30.093, "US", "St. Marks FL", "Heterandria formosa", "high", 15,
-84.209, 30.093, "US", "St. Marks FL", "Poecilia latipinna", "low", 15,
)
low <- df %>% dplyr::filter(type == "low")
high <- df %>% dplyr::filter(type == "high")
df <- tibble::frame_data(~long, ~lat, ~country, ~location, ~lab, ~type, ~site,
-97, 25.9, "US", "Brownsville TX", "Poecilia latipinna", "low", 1,
-97, 25.9,"US", "Brownsville TX", "Gambusia affinis", "high",1,
-98.5, 20.8, "Mexico", "Calnali HGO", "Xiphophorus malinche", "low",2,
-98.5, 20.8, "Mexico","Calnali HGO","Pseudoxiphophorus jonesii", "high",2,
-100.9, 22.1, "Mexico", "Nac. Rio Choy SLP", "Gambusia vitatta", "high",3,
-100.9, 22.1, "Mexico","Nac. Rio Choy SLP","Xiphophorus nigrensis", "low",3,
-102.525, 25.82, "Mexico", "4 Ciénegas COAH", "Xiphophorus gordoni", "low", 4,
-102.525, 25.82, "Mexico","4 Ciénegas COAH","Gambusia marshi", "high",4,
-98.78, 22, "Mexico", "Media luna SLP", "Poecilia latipunctata", "low",5,
-98.78, 22, "Mexico","Media luna SLP","Gambusia atrora" , "high",5,
-98.339, 21.01, "Mexico", "Atlapexco HGO", "Xiphophorus birchmanni", "low",6,
-98.339, 21.01, "Mexico", "Atlapexco HGO","Gambusia vitatta", "high",6,
-98.285, 20.834, "Mexico", "Xochiatipan HGO", "Xiphophorus variatus", "low",7,
-98.285, 20.834, "Mexico","Xochiatipan HGO","Gambusia regani", "high",7,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Poecilia velifera", "low",8,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Gambusia yucateca", "high",8,
-91.969, 17.487, "Mexico", "Palenque Chiapas", "Priapella compressa", "low", 9,
-91.969, 17.487, "Mexico","Palenque Chiapas","Phallichthys hubbsi", "high", 9,
-96.324, 19.32, "Mexico", "R. La Antigua VER", "Xiphophorus hellerii", "low", 10,
-96.324, 19.32, "Mexico","R. La Antigua VER", "Heterandria bimaculata", "high", 10,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Xiphophorus maculatus", "low", 11,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Heterophallus milleri", "high", 11,
-94.412, 18.147, "Mexico", "R. Coatzacoalcos VER", "Priapella intermedia", "low", 12,
-94.412, 18.147, "Mexico","R. Coatzacoalcos VER","Heterophallus rachovii", "high", 12,
-77.9956, 8.256, "Panama","Darien","Poecilia caucana", "low", 13,
-77.9956, 8.256, "Panama","Darien","Priapichthys darienensis", "high", 13,
-79.701, 9.1156, "Panama", "Gamboa", "Poecilia sphenops", "low", 14,
-79.701, 9.1156, "Panama","Gamboa","Neoheterandria tridentiger", "high", 14,
-84.209, 30.093, "US", "St. Marks FL", "Heterandria formosa", "high", 15,
-84.209, 30.093, "US", "St. Marks FL", "Poecilia latipinna", "low", 15
)
low <- df %>% dplyr::filter(type == "low")
high <- df %>% dplyr::filter(type == "high")
df %>%
spread(key = type, value = lab) %>%
arrange(site) %>%
select(site, high, low, location) -> my_table
us <- c(left = -120, bottom = -40, right = -30, top = 40)
map <- get_stamenmap(us, zoom = 5, maptype = "watercolor")
p <- ggmap(map) +
geom_point(data = df, aes(x = long, y = lat)) +
geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text(data = df, aes(x = long, y = lat, label = lab), vjust = 0, nudge_y = 0.5) +
# geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text_repel(data = low, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(0.1, 0.2),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# geom_text_repel(data = high, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(-0.3, -0.1),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# scale_color_powder(name = "potential for sexual conflict", guide = F) +
labs(x = "longitude", y = "latitude") +
coord_map()
cowplot::ggdraw(p) +
cowplot::draw_grob(tableGrob(my_table), 0.4, 0.48, 0.1, 0.1) +
theme_mod()
p
df <- tibble::frame_data(~long, ~lat, ~country, ~location, ~lab, ~type, ~site,
-97, 25.9, "US", "Brownsville TX", "Poecilia latipinna", "low", 2,
-97, 25.9,"US", "Brownsville TX", "Gambusia affinis", "high",2,
-98.5, 20.8, "Mexico", "Calnali HGO", "Xiphophorus malinche", "low",9,
-98.5, 20.8, "Mexico","Calnali HGO","Pseudoxiphophorus jonesii", "high",9,
-100.9, 22.1, "Mexico", "Nac. Rio Choy SLP", "Gambusia vitatta", "high",3,
-100.9, 22.1, "Mexico","Nac. Rio Choy SLP","Xiphophorus nigrensis", "low",3,
-102.525, 25.82, "Mexico", "4 Ciénegas COAH", "Xiphophorus gordoni", "low", 7,
-102.525, 25.82, "Mexico","4 Ciénegas COAH","Gambusia marshi", "high",7,
-98.78, 22, "Mexico", "Media luna SLP", "Poecilia latipunctata", "low",4,
-98.78, 22, "Mexico","Media luna SLP","Gambusia atrora" , "high",4,
-98.339, 21.01, "Mexico", "Atlapexco HGO", "Xiphophorus birchmanni", "low",6,
-98.339, 21.01, "Mexico", "Atlapexco HGO","Gambusia vitatta", "high",6,
-98.285, 20.834, "Mexico", "Xochiatipan HGO", "Xiphophorus variatus", "low",5,
-98.285, 20.834, "Mexico","Xochiatipan HGO","Gambusia regani", "high",5,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Poecilia velifera", "low",14,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Gambusia yucateca", "high",14,
-91.969, 17.487, "Mexico", "Palenque Chiapas", "Priapella compressa", "low", 13,
-91.969, 17.487, "Mexico","Palenque Chiapas","Phallichthys hubbsi", "high", 13,
-96.324, 19.32, "Mexico", "R. La Antigua VER", "Xiphophorus hellerii", "low", 8,
-96.324, 19.32, "Mexico","R. La Antigua VER", "Heterandria bimaculata", "high", 8,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Xiphophorus maculatus", "low", 12,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Heterophallus milleri", "high", 12,
-94.412, 18.147, "Mexico", "R. Coatzacoalcos VER", "Priapella intermedia", "low", 11,
-94.412, 18.147, "Mexico","R. Coatzacoalcos VER","Heterophallus rachovii", "high", 11,
-77.9956, 8.256, "Panama","Darien","Poecilia caucana", "low", 16,
-77.9956, 8.256, "Panama","Darien","Priapichthys darienensis", "high", 16,
-79.701, 9.1156, "Panama", "Gamboa", "Poecilia sphenops", "low", 15,
-79.701, 9.1156, "Panama","Gamboa","Neoheterandria tridentiger", "high", 15,
-84.209, 30.093, "US", "St. Marks FL", "Heterandria formosa", "high", 1,
-84.209, 30.093, "US", "St. Marks FL", "Poecilia latipinna", "low", 1
)
low <- df %>% dplyr::filter(type == "low")
high <- df %>% dplyr::filter(type == "high")
df %>%
spread(key = type, value = lab) %>%
arrange(site) %>%
select(site, high, low, location) -> my_table
us <- c(left = -120, bottom = -40, right = -30, top = 40)
map <- get_stamenmap(us, zoom = 5, maptype = "watercolor")
p <- ggmap(map) +
geom_point(data = df, aes(x = long, y = lat)) +
geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text(data = df, aes(x = long, y = lat, label = lab), vjust = 0, nudge_y = 0.5) +
# geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text_repel(data = low, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(0.1, 0.2),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# geom_text_repel(data = high, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(-0.3, -0.1),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# scale_color_powder(name = "potential for sexual conflict", guide = F) +
labs(x = "longitude", y = "latitude") +
coord_map()
p
nrow(df)
df <- tibble::frame_data(~long, ~lat, ~country, ~location, ~lab, ~type, ~site,
-97, 25.9, "US", "Brownsville TX", "Poecilia latipinna", "low", 2,
-97, 25.9,"US", "Brownsville TX", "Gambusia affinis", "high",2,
-98.5, 20.8, "Mexico", "Calnali HGO", "Xiphophorus malinche", "low",9,
-98.5, 20.8, "Mexico","Calnali HGO","Pseudoxiphophorus jonesii", "high",9,
-100.9, 22.1, "Mexico", "Nac. Rio Choy SLP", "Gambusia vitatta", "high",3,
-100.9, 22.1, "Mexico","Nac. Rio Choy SLP","Xiphophorus nigrensis", "low",3,
-102.525, 25.82, "Mexico", "4 Ciénegas COAH", "Xiphophorus gordoni", "low", 7,
-102.525, 25.82, "Mexico","4 Ciénegas COAH","Gambusia marshi", "high",7,
-98.78, 22, "Mexico", "Media luna SLP", "Poecilia latipunctata", "low",4,
-98.78, 22, "Mexico","Media luna SLP","Gambusia atrora" , "high",4,
-98.339, 21.01, "Mexico", "Atlapexco HGO", "Xiphophorus birchmanni", "low",6,
-98.339, 21.01, "Mexico", "Atlapexco HGO","Gambusia vitatta", "high",6,
-98.285, 20.834, "Mexico", "Xochiatipan HGO", "Xiphophorus variatus", "low",5,
-98.285, 20.834, "Mexico","Xochiatipan HGO","Gambusia regani", "high",5,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Poecilia velifera", "low",13,
-87.07, 20.62, "Mexico", "Cenote Azul QR", "Gambusia yucateca", "high",13,
-91.969, 17.487, "Mexico", "Palenque Chiapas", "Priapella compressa", "low", 12,
-91.969, 17.487, "Mexico","Palenque Chiapas","Phallichthys hubbsi", "high", 12,
-96.324, 19.32, "Mexico", "R. La Antigua VER", "Xiphophorus hellerii", "low", 8,
-96.324, 19.32, "Mexico","R. La Antigua VER", "Heterandria bimaculata", "high", 8,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Xiphophorus maculatus", "low", 11,
-93.352, 17.0283, "Mexico","R. Grijalva CHIAPAS","Heterophallus milleri", "high", 11,
-94.412, 18.147, "Mexico", "R. Coatzacoalcos VER", "Priapella intermedia", "low", 10,
-94.412, 18.147, "Mexico","R. Coatzacoalcos VER","Heterophallus rachovii", "high", 10,
-77.9956, 8.256, "Panama","Darien","Poecilia caucana", "low", 15,
-77.9956, 8.256, "Panama","Darien","Priapichthys darienensis", "high", 15,
-79.701, 9.1156, "Panama", "Gamboa", "Poecilia sphenops", "low", 14,
-79.701, 9.1156, "Panama","Gamboa","Neoheterandria tridentiger", "high", 14,
-84.209, 30.093, "US", "St. Marks FL", "Heterandria formosa", "high", 1,
-84.209, 30.093, "US", "St. Marks FL", "Poecilia latipinna", "low", 1
)
low <- df %>% dplyr::filter(type == "low")
high <- df %>% dplyr::filter(type == "high")
df %>%
spread(key = type, value = lab) %>%
arrange(site) %>%
select(site, high, low, location) -> my_table
p <- ggmap(map) +
geom_point(data = df, aes(x = long, y = lat)) +
geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text(data = df, aes(x = long, y = lat, label = lab), vjust = 0, nudge_y = 0.5) +
# geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text_repel(data = low, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(0.1, 0.2),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# geom_text_repel(data = high, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(-0.3, -0.1),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# scale_color_powder(name = "potential for sexual conflict", guide = F) +
labs(x = "longitude", y = "latitude") +
coord_map()
p
cowplot::ggdraw(p) +
cowplot::draw_grob(tableGrob(my_table), 0.4, 0.48, 0.1, 0.1) +
theme_mod()
ggsave("~/Desktop/figures_for_molly/map.pdf", height = 8, width = 7)
us <- c(left = -120, bottom = 0, right = -30, top = 40)
map <- get_stamenmap(us, zoom = 5, maptype = "watercolor")
(p <- ggmap(map) +
geom_point(data = df, aes(x = long, y = lat)) +
geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text(data = df, aes(x = long, y = lat, label = lab), vjust = 0, nudge_y = 0.5) +
# geom_text_repel(data = high, aes(x = long, y = lat, label = site)) +
# geom_text_repel(data = low, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(0.1, 0.2),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# geom_text_repel(data = high, mapping = aes(x = long, y = lat, label = lab, color = type), xlim = c(-0.3, -0.1),  size = 5, force = 2, box.padding = unit(0.5, 'lines')) +
# scale_color_powder(name = "potential for sexual conflict", guide = F) +
labs(x = "longitude", y = "latitude") +
coord_map())
ggsave("~/Desktop/figures_for_molly/map_short.pdf", height = 5, width = 7)
cowplot::ggdraw(p) +
cowplot::draw_grob(tableGrob(my_table), 0.4, 0.48, 0.1, 0.1) +
theme_mod()
df <- read_csv("df_wide.csv")
require(ggrepel)
df %>%
group_by(`Well-developed precopulatory behavior`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Well-developed precopulatory behavior`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues(guide = F) +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Granular tissue on the dorsal part of the hook on ray 3 of the gonopodium`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Granular tissue on the dorsal part of the hook on ray 3 of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues(guide = F) +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Well-developed precopulatory behavior`, `Granular tissue on the dorsal part of the hook on ray 3 of the gonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Granular tissue on the dorsal part of the hook on ray 3 of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues(guide = F) +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Well-developed precopulatory behavior`, `Granular tissue on the dorsal part of the hook on ray 3 of the gonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Granular tissue on the dorsal part of the hook on ray 3 of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df$`Granular tissue on the dorsal part of the hook on ray 3 of the gonopodium`
df %>%
group_by(sword, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(sword != "NA") %>%
ggplot(aes(factor(sword), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues(guide = F) +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(sword, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(sword != "NA") %>%
ggplot(aes(factor(sword), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(sword, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(sword != "NA")
x <- c(11,12,0,3)
table(x)
chisq.test(x)
as.table(x)
x
chisq.test(matrix(x, ncol = 2))
df %>%
group_by(`Well-developed precopulatory behavior`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues(guide = F) +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Well-developed precopulatory behavior`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count
df %>%
group_by(`Well-developed precopulatory behavior`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count
chisq.test(matrix(c(5,10,0,3), ncol = 2))
df %>%
group_by(`Well-developed precopulatory behavior`, `Subdistal spines on ray 3 of the gonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Subdistal spines on ray 3 of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Well-developed precopulatory behavior`, `Subdistal spines on ray 3 of the gonopodium`) %>%
count
chisq.test(matrix(c(3,12,2,1), ncol = 2))
df %>%
group_by(`Well-developed precopulatory behavior`, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(`Well-developed precopulatory behavior` != "NA") %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format()) +
coord_polar()
df %>%
group_by(`Well-developed precopulatory behavior`, `Distal serrae on ray 4p of the gonopodium.`) %>%
count %>%
ggplot(aes(factor(`Well-developed precopulatory behavior`), n, fill = factor(`Distal serrae on ray 4p of the gonopodium.`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Well-developed precopulatory behavior`, `Distal serrae on ray 4p of the gonopodium.`) %>%
count
chisq.test(matrix(c(2,12,3,1), ncol = 2))
df %>%
group_by(sword, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(sword != "NA") %>%
ggplot(aes(factor(sword), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(open_display, `Distal serrae on ray 4p of the gonopodium.`) %>%
count %>%
ggplot(aes(factor(open_display), n, fill = factor(`Distal serrae on ray 4p of the gonopodium.`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format()) +
coord_polar()
df %>%
group_by(open_display, `Distal serrae on ray 4p of the gonopodium.`) %>%
count
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format()) +
coord_polar()
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count
chisq.test(matrix(c(9,0,6,4), ncol = 2))
df %>%
group_by(open_display, `Subdistal spines on ray 3 of the gonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Subdistal spines on ray 3 of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(open_display, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues(guide = F) +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(open_display, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(open_display, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format()) +
coord_polar()
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues()
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Well-formedhookonray5aofthegonopodium`)))
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill")
df %>%
group_by(open_display, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(open_display != "NA") %>%
ggplot(aes(factor(open_display), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues()
View(df)
df %>%
group_by(`Vertical bar`, `Distal serrae on ray 4p of the gonopodium.`) %>%
count
df %>%
group_by(`Vertical bars`, `Distal serrae on ray 4p of the gonopodium.`) %>%
count
df %>%
group_by(`Vertical bars`, `Distal serrae on ray 4p of the gonopodium.`) %>%
count %>%
ggplot(aes(factor(`Vertical bars`), n, fill = factor(`Distal serrae on ray 4p of the gonopodium.`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format()) +
coord_polar()
df %>%
group_by(`Vertical bars`, `Well-formedhookonray5aofthegonopodium`) %>%
count %>%
filter(`Vertical bars` != "NA") %>%
ggplot(aes(factor(`Vertical bars`), n, fill = factor(`Well-formedhookonray5aofthegonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format()) +
coord_polar()
df %>%
group_by(`Vertical bars`, `Subdistal spines on ray 3 of the gonopodium`) %>%
count %>%
filter(`Vertical bars`` != "NA") %>%
ggplot(aes(factor(`Vertical bars`), n, fill = factor(`Subdistal spines on ray 3 of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Vertical bars`, `Subdistal spines on ray 3 of the gonopodium`) %>%
count %>%
filter(`Vertical bars` != "NA") %>%
ggplot(aes(factor(`Vertical bars`), n, fill = factor(`Subdistal spines on ray 3 of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Vertical bars`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(`Vertical bars` != "NA") %>%
ggplot(aes(factor(`Vertical bars`), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues(guide = F) +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Vertical bars`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(`Vertical bars` != "NA") %>%
ggplot(aes(factor(`Vertical bars`), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(`Vertical bars`, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(`Vertical bars` != "NA") %>%
ggplot(aes(factor(`Vertical bars`), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
df %>%
group_by(sword, `Size of segments of the distal ramus of ray 4a of the gonopodium`) %>%
count %>%
filter(sword != "NA") %>%
ggplot(aes(factor(sword), n, fill = factor(`Size of segments of the distal ramus of ray 4a of the gonopodium`))) +
geom_bar(stat = "identity",position = "fill") +
scale_fill_blues() +
scale_y_continuous(labels = scales::percent_format())
